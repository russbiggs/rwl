#!/usr/bin/env node

var fs = require('fs');
var commander = require('commander');
var rwl = require('../');


commander.version(require('../package.json').version)
    .usage('[options] [file]')
    .description('Convert Tucson ring width .rwl file to JSON.')
    .option("-o, --out <file>", "output file name; defaults to stdout")
    .parse(process.argv);

if (commander.args.length === 0) {
    console.error();
    console.error("  error: no input file given");
    console.error();
    process.exit(1);
}

fs.readFile(commander.args[0], 'utf8', function(err, data) {
    var rwlJson = rwl(data);
    if (!commander.out) {
        process.stdout.write(rwlJson);
    } else {
        fs.writeFile(commander.out, rwlJson, function() {
            console.log(commander.out + " written ðŸŒ²");
        });
    }
});